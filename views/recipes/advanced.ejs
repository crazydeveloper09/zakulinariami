<%- include("../partials/header") %>

<div class="container customContainer">
    
    
 
   
    <div class="row">
        <div class="col-lg-12">
            <h1 class="headerp text-center">
                Zaawansowane wyszukiwanie przepisów - znaleziono <%= recipes.length %> 
                <% if(recipes.length === 1){ %>
                    przepis
                <% } else { %>
                    przepisów
                <% } %>
               
            </h1>
            <div class="alert alert-secondary">
                
                <ul class="description">
                    Parametry:
                    <li>
                        Tytuł - <strong><%= param.title %></strong> <a data-bs-toggle="modal" data-bs-target="#searchRecipe" style="margin-left: 8px;cursor:pointer"> zmień</a>
                    </li>
                    <li>
                        Poziom - <strong><%= param.level %></strong> <a data-bs-toggle="modal" data-bs-target="#searchRecipe" style="margin-left: 8px;cursor:pointer"> zmień</a>
                    </li>
                    <li>
                        Czas - 
                        <strong>
                            <% if(param.time === '15'){ %>
                                15min
                            <% } else if(param.time === '30') { %>
                                30min
                            <% } else if(param.time === '45') { %>
                                45min
                            <% } else if(param.time === '59'){ %>
                                50min
                            <% } else { %>
                                1h
                            <% } %>
                        </strong> <a data-bs-toggle="modal" data-bs-target="#searchRecipe" style="margin-left: 8px;cursor:pointer"> zmień</a>
                    </li>
                    <li>
                        Ilość porcji - <strong><%= param.portion %></strong> <a data-bs-toggle="modal" data-bs-target="#searchRecipe" style="margin-left: 8px;cursor:pointer"> zmień</a>
                    </li>
                </ul>
               
            </div>
            <% if(currentUser && currentUser.username === "Admin"){ %>
                <div class="text-center">
                    <a href="/recipes/category/new" class="btn btn-outline-dark">Dodaj nową kategorię</a>
                </div>
                
            <% } %>
            
				
            <% if(categories.length !== 0){ %>
                <div class="dropdown text-center">
                    <button class="btn btn-outline-dark dropdown-toggle justify-content-center" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                       Wybierz kategorię
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <% for(let i=0; i< categories.length; i++){ %>
                            <a class="dropdown-item" href="/recipes/category/<%= categories[i].link %>"><%= categories[i].name %></a>
                        <% } %>
                        
                    </div>
                </div>
                <br>
            <% } %>
            
        </div>
    </div>

    <% if(recipes.length===0){ %>
        <div class="row justify-content-center">
            <div class="col-lg-6 col-md-12">
                <div class="alert alert-secondary text-center" role="alert">
                    Nie znaleźliśmy przepisów dla podanych powyżej parametrów. Spróbuj ponownie:
                </div>
            </div>
        </div>
    <% } else { %>
        <div class="row">
                
                    <% for(let i=recipes.length-1; i>=0;i--){ %>
                        <%- include("../partials/recipe", { recipe: recipes[i] }) %>
                    <% } %>
                
        </div>
       
    <% } %>
    
    <div class="modal fade" id="searchRecipe" tabindex="-1" role="dialog" aria-labelledby="searchRecipe" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title headerp">Wyszukaj przepis</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/recipes/advanced/search" method="get">
					
                        <span class="description">
                            Wpisz tytuł przepisu
                            <button type="button" style="background: transparent;border: none;" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Nie pamiętasz dokładnie tytułu przepisu? Żaden problem. Wystarczy, że wpiszesz słowo kluczowe lub ciąg liter">
                                <i class="fas fa-info-circle" style="color: #212529;"></i>
                            </button>
                        </span>
                        <input type="text" id="news" value="<%= param.title %>" autocomplete="off" class="form-control" name="title" placeholder="Tytuł przepisu" aria-label="Tytuł przepisu" aria-describedby="basic-addon2">
                        <br>
                        <span class="description">
                            Wybierz ilość porcji
                            <button type="button" style="background: transparent;border: none;" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Niezależnie którą opcję zaznaczysz to wyszukuje również równo 3">
                                <i class="fas fa-info-circle" style="color: #212529;"></i>
                            </button>
                        </span>
                        <div class="radios">
                            <% if(param.portion === "Więcej niż 3"){ %> 
                                <label class="radio">
                                    <input type="radio" name="portion" value="3" checked>
                                    <div class="radioButton"></div>
                                    Więcej niż 3
                                </label>
                                <label class="radio">
                                    <input type="radio" name="portion" value="3s">
                                    <div class="radioButton"></div>
                                    Mniej niż 3
                                </label>
                            <% } else { %>
                                <label class="radio">
                                    <input type="radio" name="portion" value="3">
                                    <div class="radioButton"></div>
                                    Więcej niż 3
                                </label>
                                <label class="radio">
                                    <input type="radio" name="portion" value="3s" checked>
                                    <div class="radioButton"></div>
                                    Mniej niż 3
                                </label>
                            <% } %>
                            
                        </div>
                        
                       
                        <span class="description">
                            Wybierz czas przygotowania
                            <button type="button" style="background: transparent;border: none;" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Jeśli zaznaczasz opcję z minutami to wyszukuje również mniejszą wartość.">
                                <i class="fas fa-info-circle" style="color: #212529;"></i>
                            </button>
                        </span>
                        <div class="radios">
                            <% if(param.time === '15'){ %> 
                                <label class="radio">
                                    <input type="radio" name="time" value="15" checked>
                                    <div class="radioButton"></div>
                                    15min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="30">
                                    <div class="radioButton"></div>
                                    30min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="45">
                                    <div class="radioButton"></div>
                                    45min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="59">
                                    <div class="radioButton"></div>
                                    59min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="1">
                                    <div class="radioButton"></div>
                                    Więcej niż godzina
                                </label>
                            <% } else if(param.time === '30'){ %>
                                <label class="radio">
                                    <input type="radio" name="time" value="15">
                                    <div class="radioButton"></div>
                                    15min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="30" checked>
                                    <div class="radioButton"></div>
                                    30min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="45">
                                    <div class="radioButton"></div>
                                    45min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="59">
                                    <div class="radioButton"></div>
                                    59min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="1">
                                    <div class="radioButton"></div>
                                    Więcej niż godzina
                                </label>
                            <% } else if(param.time === '45') { %>
                                <label class="radio">
                                    <input type="radio" name="time" value="15">
                                    <div class="radioButton"></div>
                                    15min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="30">
                                    <div class="radioButton"></div>
                                    30min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="45" checked>
                                    <div class="radioButton"></div>
                                    45min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="59">
                                    <div class="radioButton"></div>
                                    59min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="1">
                                    <div class="radioButton"></div>
                                    Więcej niż godzina
                                </label>
                            <% } else if(param.time === '59'){ %>
                                <label class="radio">
                                    <input type="radio" name="time" value="15">
                                    <div class="radioButton"></div>
                                    15min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="30">
                                    <div class="radioButton"></div>
                                    30min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="45">
                                    <div class="radioButton"></div>
                                    45min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="59" checked>
                                    <div class="radioButton"></div>
                                    59min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="1">
                                    <div class="radioButton"></div>
                                    Więcej niż godzina
                                </label>
                            <% } else { %>
                                <label class="radio">
                                    <input type="radio" name="time" value="15">
                                    <div class="radioButton"></div>
                                    15min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="30">
                                    <div class="radioButton"></div>
                                    30min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="45">
                                    <div class="radioButton"></div>
                                    45min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="59">
                                    <div class="radioButton"></div>
                                    59min
                                </label>
                                <label class="radio">
                                    <input type="radio" name="time" value="1" checked>
                                    <div class="radioButton"></div>
                                    Więcej niż godzina
                                </label>
                            <% } %>
                            
                        </div>
                        
                        <span class="description">
                            Wybierz poziom zaawansowania
                           
                        </span>
                        <div class="radios">
                            <% if(param.level === "Łatwy"){ %> 
                                <label class="radio">
                                    <input type="radio" name="level" value="Łatwy" checked>
                                    <div class="radioButton"></div>
                                    Łatwy
                                </label>
                                <label class="radio">
                                    <input type="radio" name="level" value="Średni" id="">
                                    <div class="radioButton"></div>
                                    Średni
                                </label>
                                <label for="advanced" class="radio">
                                    <input type="radio" name="level" value="Zaawansowany" id="advanced">
                                    <div class="radioButton"></div>
                                    Zaawansowany
                                </label>
                            <% } else if(param.level === "Średni"){ %>
                                <label class="radio">
                                    <input type="radio" name="level" value="Łatwy">
                                    <div class="radioButton"></div>
                                    Łatwy
                                </label>
                                <label class="radio">
                                    <input type="radio" name="level" value="Średni" id="" checked>
                                    <div class="radioButton"></div>
                                    Średni
                                </label>
                                <label for="advanced" class="radio">
                                    <input type="radio" name="level" value="Zaawansowany" id="advanced">
                                    <div class="radioButton"></div>
                                    Zaawansowany
                                </label>
                            <% } else { %>
                                <label class="radio">
                                    <input type="radio" name="level" value="Łatwy">
                                    <div class="radioButton"></div>
                                    Łatwy
                                </label>
                                <label class="radio">
                                    <input type="radio" name="level" value="Średni" id="">
                                    <div class="radioButton"></div>
                                    Średni
                                </label>
                                <label for="advanced" class="radio">
                                    <input type="radio" name="level" value="Zaawansowany" id="advanced" checked>
                                    <div class="radioButton"></div>
                                    Zaawansowany
                                </label>
                            <% } %>
                            
                        </div>
                        
                        <input type="submit" value="Szukaj przepis" class="btn btn-green">
                        
					
				</form>
              
                
            </div>
           
          </div>
        </div>
      </div>
</div>
<script>
    $(function () {
        $('[data-toggle="popover"]').popover()
    })
</script>
<%- include("../partials/footer") %>